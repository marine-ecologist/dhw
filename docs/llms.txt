# Installation

## dhw: an R package for calculating various SST metrics (Maximum Monthly Mean Climatology, SST Anomalies, Coral Bleaching HotSpots, Degree Heating Weeks)

![](reference/figures/logo2.png) The **dhw** package calculates SST
metrics from raw SST datasets by following the methods of the National
Oceanic and Atmospheric Administration’s (NOAA) [Coral Reef Watch (CRW)
Coral Bleaching Heat Stress Product Suite Version
3.1](https://coralreefwatch.noaa.gov) (see [Skirving et
al. 2020](https://www.mdpi.com/2072-4292/12/23/3856)%20) for product
description and methods).  
  
The NOAA Coral Reef Watch (CRW) daily global 5km satellite coral
bleaching [Degree Heating Week
(DHW)](https://coralreefwatch.noaa.gov/product/5km/index_5km_dhw.php)
product shows accumulated heat stress during the most recent 12-week
period, and ranges from 0 to 20 °C-weeks. DHW is directly related to the
timing and intensity of coral bleaching and is the most common metric in
assessing coral bleaching events (see
[here](https://coralreefwatch.noaa.gov/product/5km/index_5km_dhw.php)
for further details).  
  
Due to changes in the datasets used by the
[CRW](https://coralreefwatch.noaa.gov/product/5km/index_5km_sst.php)
over the years (see [Skirving et
al. 2020](https://www.mdpi.com/2072-4292/12/23/3856)%20) for details),
the
[CoralTemp](https://coralreefwatch.noaa.gov/product/5km/index_5km_sst.php)
degree heating weeks (and other SST metrics) are calculated against a
specific baseline climatology (1985–1990 and 1993) to allow for
internally consistent anomaly products.  
  
The `dhw` package provides a series of functions to recreate the
algorithms for the CRW metrics (Maximum Monthly Mean Climatology, SST
Anomalies, Coral Bleaching HotSpots, Degree Heating Weeks) using any SST
product (e.g.,
[OISST](https://www.ncei.noaa.gov/products/optimum-interpolation-sst))
that spans the baseline period of 1985 to 1993.  
  
The package is uses the `terra` package to process the `raster` data and
is (potentially) slower than other R packages (e.g. `stars`) and very
much slower than other alternatives (e.g. `cdo`) for large datasets.
Updated versions of the package will switch to `stars` spatiotemporal
arrays and raster data cubes, and provide alternative functions for
`cdo` to speed up large datasets.  
  
Also included are a series of functions for visualising SST metrics and
functions to reliably download common datasets (e.g. CRW, OISST) via the
[NOAA NCEI thredds server](http://www.ncei.noaa.gov).  
  
  
![](https://github.com/user-attachments/assets/1e134f49-22d4-46ae-a208-d7fc18987caa)

Please file any [issues](https://github.com/marine-ecologist/dhw/issues)
and comments and suggestions to <george.roff@csiro.au>.

the current development version of `dhw` can be installed from github:

``` r
#install.packages("remotes")
devtools::install_github("https://github.com/marine-ecologist/dhw", force=TRUE)
```

# References

Skirving *et al* (2020) Remote Sensing 12(3856)
[doi:10.3390/rs12233856](https://www.mdpi.com/2072-4292/12/23/3856)

# Package index

## Climatologies and SST Metrics

- [`create_climatology()`](https://marine-ecologist.github.io/dhw/reference/create_climatology.md)
  : Create climatology
- [`calculate_monthly_mean()`](https://marine-ecologist.github.io/dhw/reference/calculate_monthly_mean.md)
  : Create Monthly Mean (MMM)
- [`calculate_maximum_monthly_mean()`](https://marine-ecologist.github.io/dhw/reference/calculate_maximum_monthly_mean.md)
  : Create Maximum Monthly Mean (MMM)
- [`calculate_daily_climatology()`](https://marine-ecologist.github.io/dhw/reference/calculate_daily_climatology.md)
  : Calculate Daily Climatology
- [`calculate_anomalies()`](https://marine-ecologist.github.io/dhw/reference/calculate_anomalies.md)
  : Calculate anomalies
- [`calculate_hotspots()`](https://marine-ecologist.github.io/dhw/reference/calculate_hotspots.md)
  : Calculate hotspots
- [`calculate_dhw()`](https://marine-ecologist.github.io/dhw/reference/calculate_dhw.md)
  : Calculate DHW
- [`calculate_baa()`](https://marine-ecologist.github.io/dhw/reference/calculate_baa.md)
  : Calculate BAA
- [`calculate_dhmi()`](https://marine-ecologist.github.io/dhw/reference/calculate_dhmi.md)
  : Calculate Degree Heating Month Index (DHMi)
- [`hindcast()`](https://marine-ecologist.github.io/dhw/reference/hindcast.md)
  : Hindcast Bias-Corrected Raster Time Series via Monthly Anomaly
  Quantile Mapping (QM/QDM)

## Download data

- [`download_CoralTemp()`](https://marine-ecologist.github.io/dhw/reference/download_CoralTemp.md)
  : Download CoralTemp data
- [`download_OISST()`](https://marine-ecologist.github.io/dhw/reference/download_OISST.md)
  : Download OISST data
- [`download_gbr_spatial()`](https://marine-ecologist.github.io/dhw/reference/download_gbr_spatial.md)
  : Download GBR spatial data
- [`download_ERA5()`](https://marine-ecologist.github.io/dhw/reference/download_ERA5.md)
  : Download ERA5 data
- [`process_ERA5()`](https://marine-ecologist.github.io/dhw/reference/process_ERA5.md)
  : Process ERA5 NetCDF Files
- [`process_CoralTemp()`](https://marine-ecologist.github.io/dhw/reference/process_CoralTemp.md)
  : Process CoralTemp NetCDF files into a combined raster
- [`process_OISST()`](https://marine-ecologist.github.io/dhw/reference/process_OISST.md)
  : Download GBR spatial data

## Visualise data

- [`plot_annual_dhw()`](https://marine-ecologist.github.io/dhw/reference/plot_annual_dhw.md)
  : Plot mean monthly maximum for a given gridcell
- [`plot_max_dhw()`](https://marine-ecologist.github.io/dhw/reference/plot_annual_dhw_max.md)
  : Plot annual maximum DHW time series
- [`plot_mm()`](https://marine-ecologist.github.io/dhw/reference/plot_mm.md)
  : Plot mean monthly maximum for a given gridcell
- [`plot_sst_timeseries()`](https://marine-ecologist.github.io/dhw/reference/plot_sst_timeseries.md)
  : Plot seasonal SST vs. MMM with bleaching status
- [`plot2()`](https://marine-ecologist.github.io/dhw/reference/plot2.md)
  : Simple XY plot for terra::rast values() comparisons

## Source data

- [`NOAA_CRW_data`](https://marine-ecologist.github.io/dhw/reference/NOAA_CRW_data.md)
  : NOAA_CRW_data

## Assist functions

- [`summarise_raster()`](https://marine-ecologist.github.io/dhw/reference/summarise_raster.md)
  : Summarise rasters to year
- [`st_polygon_from_bbox()`](https://marine-ecologist.github.io/dhw/reference/st_polygon_from_bbox.md)
  : Create sf polygon from bbox
- [`extract_reefs()`](https://marine-ecologist.github.io/dhw/reference/extract_reefs.md)
  : Extract reef
- [`as_climatology_df()`](https://marine-ecologist.github.io/dhw/reference/as_climatology_df.md)
  : Flatten climatology outputs (list of SpatRaster) to a tidy
  data.frame
- [`isComplete()`](https://marine-ecologist.github.io/dhw/reference/isComplete.md)
  : Check completeness of dated NetCDF files by filename
- [`check_missing_dates()`](https://marine-ecologist.github.io/dhw/reference/check_missing_dates.md)
  : Check missing dates
- [`process_year()`](https://marine-ecologist.github.io/dhw/reference/process_year.md)
  : Process NetCDF rasters for a given year
- [`calculate_metrics()`](https://marine-ecologist.github.io/dhw/reference/calculate_metrics.md)
  : Calculate SST Variability Metrics

# Articles

### All vignettes

- [Calculating Degree Heating
  Weeks](https://marine-ecologist.github.io/dhw/articles/calculating_climatologies.md):
- [Extracting SST and spatial
  data](https://marine-ecologist.github.io/dhw/articles/extracting_data.md):
- [Validating DHW
  climatologies](https://marine-ecologist.github.io/dhw/articles/validating_climatologies.md):
- [Visualising DHW
  outputs](https://marine-ecologist.github.io/dhw/articles/visualising_outputs.md):
- [Extended Degree Heating
  Weeks](https://marine-ecologist.github.io/dhw/articles/dhw_extended.md):
- [Monthly-anomaly Quantile Mapping (QM) hindcast
  reconstructions](https://marine-ecologist.github.io/dhw/articles/hindcast.md):
- [Bayesian changepoint detection and
  OISST2](https://marine-ecologist.github.io/dhw/articles/changepoint.md):
