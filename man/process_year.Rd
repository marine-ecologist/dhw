% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/process_year.R
\name{process_year}
\alias{process_year}
\title{Process NetCDF rasters for a given year}
\usage{
process_year(
  year_dir,
  polygon,
  crop,
  mask,
  downsample,
  res,
  variable,
  preliminary
)
}
\arguments{
\item{year_dir}{Character. Path to the directory containing \code{.nc} files for a single year.}

\item{polygon}{An \code{sf} polygon object. Used for cropping and/or masking rasters.}

\item{crop}{Logical. If \code{TRUE}, crops rasters to the extent of \code{polygon}.}

\item{mask}{Logical. If \code{TRUE}, masks rasters to the interior of \code{polygon}.}

\item{downsample}{Logical. If \code{TRUE}, resamples rasters to a coarser grid of resolution \code{res}.}

\item{res}{Numeric (length 1 or 2). Target resolution for downsampling (map units of CRS).}

\item{variable}{Character. Variable name prefix to extract from NetCDF (e.g. \code{"sst"}).
The function appends \code{"_zlev=0"} to match surface data layers.}

\item{preliminary}{Logical. If \code{TRUE}, allows processing of files flagged as preliminary.
If \code{FALSE} (default), the function will stop if preliminary data are found.}
}
\value{
Character. Path to the combined yearly raster written to a temporary GeoTIFF,
or \code{NULL} if no valid rasters were processed.
}
\description{
This function processes a directory of NetCDF files by extracting a specified
variable (surface level only), cropping/masking to a polygon, and optionally
downsampling to a target resolution. It outputs a single combined raster for
the year and writes it to a temporary GeoTIFF file.
}
\details{
The function:
\enumerate{
\item Scans \code{year_dir} for \code{.nc} files.
\item Skips or replaces filenames with \verb{_preliminary.nc} depending on \code{preliminary}.
\item Extracts the specified variable at surface depth (\code{zlev=0}).
\item Applies optional crop/mask/downsample steps.
\item Combines rasters and writes out a GeoTIFF file in the session temp directory.
}
}
\examples{
\dontrun{
library(sf)
poly <- st_read("polygon.gpkg")
tif <- process_year("data/1998", poly, crop = TRUE, mask = TRUE,
                    downsample = TRUE, res = 0.1, variable = "sst", preliminary = FALSE)
raster <- terra::rast(tif)
}
}
